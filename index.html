<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
<title>小熊猫的花园</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">



    <meta property="og:type" content="website">
<meta property="og:title" content="小熊猫的花园">
<meta property="og:url" content="http://jane66.com/index.html">
<meta property="og:site_name" content="小熊猫的花园">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小熊猫的花园">





<link rel="icon" href="/images/favicon.png">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    

<link rel="stylesheet" href="/css/back-to-top.css">


    
    

    
    
    
    

    
    
<link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.png" alt="小熊猫的花园" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active" href="/">主页</a>
                
                <a class="navbar-item" href="/archives">归档</a>
                
                <a class="navbar-item" href="/categories">分类</a>
                
                <a class="navbar-item" href="/tags">标签</a>
                
                <a class="navbar-item" href="/about">关于</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-08-29T01:50:00.000Z">2018-08-29</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/工作/">工作</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/工作/小程序/">小程序</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分钟 读完 (大约 1402 个字)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/08/29/微信小程序中绘制雷达图/">微信小程序中绘制雷达图</a>
            
        </h1>
        <div class="content">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>雷达图（Radar Chart），又可称为戴布拉图、蜘蛛网图（Spider Chart），是财务分析报表的一种。使用者能一目了然的了解各项指标的变动情形及其好坏趋向。<br>本文介绍如何在微信小程序中实现雷达图绘制。<br><img src="https://upload-images.jianshu.io/upload_images/2641798-4cb2f61add473cd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="雷达图"></p>
<h2 id="绘制背景"><a href="#绘制背景" class="headerlink" title="绘制背景"></a>绘制背景</h2><p>首先我们需要绘制出雷达图后面的“蜘蛛网”。具体原理就是一层一层将多边形画出来，根据数据长度决定每一个点的位置和半径长度。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">var angle = Math.PI * 2 / length;</span><br><span class="line">for (var layer = 5; layer &gt; 0; layer--) &#123;</span><br><span class="line">        context.beginPath();</span><br><span class="line">        context.setGlobalAlpha(1);</span><br><span class="line">        context.setStrokeStyle(&quot;#D3D3D3&quot;);</span><br><span class="line">        if (layer % 2 != 0) &#123;</span><br><span class="line">          context.setFillStyle(&quot;white&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          context.setFillStyle(&quot;#F5F5F5&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        var currentRad = layer / 5 * radius;</span><br><span class="line">        context.moveTo(center.x, center.y - currentRad);</span><br><span class="line">        var currentAngle = -Math.PI / 2;</span><br><span class="line">        for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">          context.lineTo(center.x + currentRad * Math.cos(currentAngle), center.y + currentRad * Math.sin(currentAngle));</span><br><span class="line">          currentAngle += angle;</span><br><span class="line">        &#125;</span><br><span class="line">        context.fill();</span><br><span class="line">        context.closePath();</span><br><span class="line">        context.stroke();</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<p>如代码所示，<code>angle</code>是根据数据长度决定的，这里为了好看，一共画五层，并且交替涂抹颜色。下图是<code>length=6</code>的效果：<br><img src="https://upload-images.jianshu.io/upload_images/2641798-482cb08a73db4b5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="蜘蛛网"></p>
<h2 id="绘制轴"><a href="#绘制轴" class="headerlink" title="绘制轴"></a>绘制轴</h2><p>接下来就是将各个顶点与圆心连接起来。有了“蜘蛛网”的经验，画轴就简单多了，只需要知道最外层顶点位置然后<code>lineTo</code>圆心就行了。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// draw Axis</span><br><span class="line">context.beginPath();</span><br><span class="line">var currentAngle = -Math.PI / 2;</span><br><span class="line">for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">  context.moveTo(center.x + radius * Math.cos(currentAngle), center.y + radius * Math.sin(currentAngle));</span><br><span class="line">  context.lineTo(center.x, center.y);</span><br><span class="line">  currentAngle += angle;</span><br><span class="line">&#125;</span><br><span class="line">context.closePath();</span><br><span class="line">context.stroke();</span><br></pre></td></tr></table></figure>
<p>以下是加上轴线后的效果：<br><img src="https://upload-images.jianshu.io/upload_images/2641798-fd3a8dd75cc634c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数轴"></p>
<h2 id="绘制指标"><a href="#绘制指标" class="headerlink" title="绘制指标"></a>绘制指标</h2><p>接下来是将各个维度指标名字添加到图表上。同数轴一样，首先需要确定最外层顶点的位置，然后根据位置调整文字显示的基准，将文字写上去。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// draw Index</span><br><span class="line">context.beginPath();</span><br><span class="line">context.setFillStyle(&quot;#D3D3D3&quot;);</span><br><span class="line">context.setFontSize(14);</span><br><span class="line">var currentAngle = -Math.PI / 2;</span><br><span class="line">for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">  var posX = center.x + radius * Math.cos(currentAngle);</span><br><span class="line">  var posY = center.y + radius * Math.sin(currentAngle);</span><br><span class="line">  if (posX &lt; center.x) context.setTextAlign(&quot;right&quot;);</span><br><span class="line">  else context.setTextAlign(&quot;left&quot;);</span><br><span class="line">  if (posY &gt; center.y) context.setTextBaseline(&quot;top&quot;);</span><br><span class="line">  else context.setTextBaseline(&quot;bottom&quot;);</span><br><span class="line">  context.fillText(that.options.xLabel[i], posX, posY);</span><br><span class="line">  currentAngle += angle;</span><br><span class="line">&#125;</span><br><span class="line">context.closePath();</span><br></pre></td></tr></table></figure>
<p>这里为了好看，对于文字要显示的位置小于中心点 x 坐标的靠右对齐，否则靠左对齐；对于文字位置大于中心点 y 坐标的基准设置在上方，否则在下方。以下是加上指标后的效果：<br><img src="https://upload-images.jianshu.io/upload_images/2641798-896f6d32eda04d07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="指标"></p>
<h2 id="绘制数据"><a href="#绘制数据" class="headerlink" title="绘制数据"></a>绘制数据</h2><p>最后，我们将数据绘制到图表上。首先，我们要确定所有数据的最大值，如果最大值大于 10，那么取 10 的倍数。然后同画“蜘蛛网”一样，将各个数据点的半径根据相对于最大值比例换算出来，然后绘制在图表上。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">// draw data</span><br><span class="line">var MaxValue = Math.max.apply(null, that.options.data[0].value);</span><br><span class="line">that.options.data.forEach(function(val) &#123;</span><br><span class="line">  var temp = Math.max.apply(null, val.value);</span><br><span class="line">  if (temp &gt; MaxValue) MaxValue = temp;</span><br><span class="line">&#125;);</span><br><span class="line">if (MaxValue &gt; 10) &#123;</span><br><span class="line">  MaxValue = Math.ceil(MaxValue / 10) * 10</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">that.options.data.forEach(function(val) &#123;</span><br><span class="line">  context.beginPath();</span><br><span class="line">  context.setStrokeStyle(val.color);</span><br><span class="line">  var currentRad = radius * val.value[0] / MaxValue * step / MaxStep;</span><br><span class="line">  context.moveTo(center.x, center.y - currentRad);</span><br><span class="line">  var currentAngle = -Math.PI / 2;</span><br><span class="line">  for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">    currentRad = radius * val.value[i] / MaxValue * step / MaxStep;</span><br><span class="line">    context.lineTo(center.x + currentRad * Math.cos(currentAngle), center.y + currentRad * Math.sin(currentAngle));</span><br><span class="line">    currentAngle += angle;</span><br><span class="line">  &#125;</span><br><span class="line">  currentRad = radius * val.value[0] / MaxValue * step / MaxStep;</span><br><span class="line">  context.lineTo(center.x, center.y - currentRad);</span><br><span class="line">  context.stroke();</span><br><span class="line">  if (that.options.area) &#123;</span><br><span class="line">    context.setFillStyle(val.color);</span><br><span class="line">    context.setGlobalAlpha(0.5);</span><br><span class="line">    context.fill();</span><br><span class="line">  &#125;</span><br><span class="line">  context.closePath();</span><br><span class="line">&#125;);</span><br><span class="line">context.draw();</span><br></pre></td></tr></table></figure>
<p>以下就是添加数据后的完整效果：<br><img src="https://upload-images.jianshu.io/upload_images/2641798-cb22523fbd815021.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数据"></p>
<h2 id="添加绘制动画"><a href="#添加绘制动画" class="headerlink" title="添加绘制动画"></a>添加绘制动画</h2><p>为了显示效果更佳，我们可以给绘制图表加上动画，具体实现如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">var angle = Math.PI * 2 / length;</span><br><span class="line"></span><br><span class="line">var step = 1;</span><br><span class="line">var MaxStep = that.options.animation ? 50 : 1;</span><br><span class="line">var animation = function() &#123;</span><br><span class="line">  if (step &lt;= MaxStep) &#123;</span><br><span class="line">    // draw background</span><br><span class="line">    for (var layer = 5; layer &gt; 0; layer--) &#123;</span><br><span class="line">      context.beginPath();</span><br><span class="line">      context.setGlobalAlpha(1);</span><br><span class="line">      context.setStrokeStyle(&quot;#D3D3D3&quot;);</span><br><span class="line">      if (layer % 2 != 0) &#123;</span><br><span class="line">        context.setFillStyle(&quot;white&quot;);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        context.setFillStyle(&quot;#F5F5F5&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      var currentRad = layer / 5 * radius;</span><br><span class="line">      context.moveTo(center.x, center.y - currentRad);</span><br><span class="line">      var currentAngle = -Math.PI / 2;</span><br><span class="line">      for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">        context.lineTo(center.x + currentRad * Math.cos(currentAngle), center.y + currentRad * Math.sin(currentAngle));</span><br><span class="line">        currentAngle += angle;</span><br><span class="line">      &#125;</span><br><span class="line">      context.fill();</span><br><span class="line">      context.closePath();</span><br><span class="line">      context.stroke();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // draw Axis</span><br><span class="line">    context.beginPath();</span><br><span class="line">    var currentAngle = -Math.PI / 2;</span><br><span class="line">    for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">      context.moveTo(center.x + radius * Math.cos(currentAngle), center.y + radius * Math.sin(currentAngle));</span><br><span class="line">      context.lineTo(center.x, center.y);</span><br><span class="line">      currentAngle += angle;</span><br><span class="line">    &#125;</span><br><span class="line">    context.closePath();</span><br><span class="line">    context.stroke();</span><br><span class="line"></span><br><span class="line">    // draw Index</span><br><span class="line">    context.beginPath();</span><br><span class="line">    context.setFillStyle(&quot;#D3D3D3&quot;);</span><br><span class="line">    context.setFontSize(14);</span><br><span class="line">    var currentAngle = -Math.PI / 2;</span><br><span class="line">    for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">      var posX = center.x + radius * Math.cos(currentAngle);</span><br><span class="line">      var posY = center.y + radius * Math.sin(currentAngle);</span><br><span class="line">      if (posX &lt; center.x) context.setTextAlign(&quot;right&quot;);</span><br><span class="line">      else context.setTextAlign(&quot;left&quot;);</span><br><span class="line">      if (posY &gt; center.y) context.setTextBaseline(&quot;top&quot;);</span><br><span class="line">      else context.setTextBaseline(&quot;bottom&quot;);</span><br><span class="line">      context.fillText(that.options.xLabel[i], posX, posY);</span><br><span class="line">      currentAngle += angle;</span><br><span class="line">    &#125;</span><br><span class="line">    context.closePath();</span><br><span class="line"></span><br><span class="line">    // draw data</span><br><span class="line">    var MaxValue = Math.max.apply(null, that.options.data[0].value);</span><br><span class="line">    that.options.data.forEach(function(val) &#123;</span><br><span class="line">      var temp = Math.max.apply(null, val.value);</span><br><span class="line">      if (temp &gt; MaxValue) MaxValue = temp;</span><br><span class="line">    &#125;);</span><br><span class="line">    if (MaxValue &gt; 10) &#123;</span><br><span class="line">      MaxValue = Math.ceil(MaxValue / 10) * 10</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    that.options.data.forEach(function(val) &#123;</span><br><span class="line">      context.beginPath();</span><br><span class="line">      context.setStrokeStyle(val.color);</span><br><span class="line">      var currentRad = radius * val.value[0] / MaxValue * step / MaxStep;</span><br><span class="line">      context.moveTo(center.x, center.y - currentRad);</span><br><span class="line">      var currentAngle = -Math.PI / 2;</span><br><span class="line">      for (var i = 0; i &lt; length; i++) &#123;</span><br><span class="line">        currentRad = radius * val.value[i] / MaxValue * step / MaxStep;</span><br><span class="line">        context.lineTo(center.x + currentRad * Math.cos(currentAngle), center.y + currentRad * Math.sin(currentAngle));</span><br><span class="line">        currentAngle += angle;</span><br><span class="line">      &#125;</span><br><span class="line">      currentRad = radius * val.value[0] / MaxValue * step / MaxStep;</span><br><span class="line">      context.lineTo(center.x, center.y - currentRad);</span><br><span class="line">      context.stroke();</span><br><span class="line">      if (that.options.area) &#123;</span><br><span class="line">        context.setFillStyle(val.color);</span><br><span class="line">        context.setGlobalAlpha(0.5);</span><br><span class="line">        context.fill();</span><br><span class="line">      &#125;</span><br><span class="line">      context.closePath();</span><br><span class="line">    &#125;);</span><br><span class="line">    context.draw();</span><br><span class="line">    step++;</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    clearInterval(aniName);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">var aniName = setInterval(animation, 10);</span><br></pre></td></tr></table></figure>
<p>最终效果如下：<br><img src="https://upload-images.jianshu.io/upload_images/2641798-d476058258f845d5.gif?imageMogr2/auto-orient/strip" alt="动画效果"></p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>😊 以上就是在微信小程序中绘制雷达图的方法。如有兴趣了解更多，可以查看完整代码：<a href="https://github.com/chmini-app/CHCharts-wechat" target="_blank" rel="noopener">https://github.com/chmini-app/CHCharts-wechat</a>。</p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2018-06-20T16:02:21.000Z">2018-06-21</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/生活/">生活</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/生活/小熊猫/">小熊猫</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    几秒 读完 (大约 0 个字)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2018/06/21/小熊猫来到世界/">小熊猫来到世界</a>
            
        </h1>
        <div class="content">
            
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2017-04-28T02:42:21.000Z">2017-04-28</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/工作/">工作</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/工作/iOS/">iOS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    12 分钟 读完 (大约 1749 个字)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2017/04/28/iOS实现类Prisma软件/">iOS实现类Prisma软件</a>
            
        </h1>
        <div class="content">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr>
<p>Prisma 在 2016 上线后就大火，该 APP 是利用<a href="https://zh.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C" target="_blank" rel="noopener">神经网络</a>和<a href="https://zh.wikipedia.org/wiki/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD" target="_blank" rel="noopener">人工智能</a>技术，为普通照片加入艺术效果的照片编辑软件。</p>
<p>同年 Google 也发布了一篇《A LEARNED REPRESENTATION FOR ARTISTIC STYLE》论文，实现了前向运算一次为照片整合多种艺术风格的功能，并且优化了内存使用和运算速度，可以在移动设备上快速运算。</p>
<p>最近在研究 Tensorflow 整合 iOS 过程中，发现 google 公开了论文实现的源码和训练数据，也就是说我们可以通过自己写一个前向运算图，整合其训练参数就可以快速实现类 Prisma 的应用。</p>
<p>下面就介绍一下如何在 iPhone 上跑一个自己的<strong>“Prisma”</strong>。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2641798-ab4749c205d9f6f8.JPG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="招财和咕噜"></p>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><hr>
<ol>
<li>安装<a href="https://www.tensorflow.org/versions/r0.12/get_started/os_setup.html#download-and-setup" target="_blank" rel="noopener">Tensorflow</a>，这个官网上有详细教程这里就不多说了。</li>
<li>搭建<a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib/ios_examples/" target="_blank" rel="noopener">iOS+Tensorflow</a>工程，这个可以根据 Git 上的步骤实现，也可以参考官方的 Demo 程序配置。（这个过程有很多坑，多次尝试，应该可以配置成功）</li>
<li>下载模型，本次使用的模型是<a href="https://github.com/tensorflow/magenta/tree/master/magenta/models/image_stylization" target="_blank" rel="noopener">image_stylization</a>，google 已开源在 GitHub 上。</li>
<li>下载训练好的参数，Google 提供了 2 个：<br><a href="http://download.magenta.tensorflow.org/models/multistyle-pastiche-generator-monet.ckpt" target="_blank" rel="noopener">Monet</a><br><a href="http://download.magenta.tensorflow.org/models/multistyle-pastiche-generator-varied.ckpt" target="_blank" rel="noopener">Varied</a><br>Monet 训练了 10 种艺术图片，Varied 训练了 32 种。<br>当然你也可以自己训练艺术图片，但是得下载 VGG 的训练参数和 ImageNet 数据，然后自己训练，比较花时间。</li>
</ol>
<h2 id="构建计算图"><a href="#构建计算图" class="headerlink" title="构建计算图"></a>构建计算图</h2><hr>
<p>虽然 Google 提供了模型的源码，但是并没有在源码中输出运算图已方便迁移到移动设备中使用，Android 的 Demo 中倒是提供了生成的 pb，如何觉得自己写计算图麻烦可以直接拷到自己 iOS 工程中使用。</p>
<p>我这里创建了一个 python 的工程，然后把 Google 源码中 model.py 相关的文件都加入了工程。<br>我的建图代码如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import tensorflow as tf</span><br><span class="line">import ast</span><br><span class="line">import os</span><br><span class="line">from tensorflow.python import pywrap_tensorflow</span><br><span class="line"></span><br><span class="line">from matplotlib import pyplot</span><br><span class="line">from matplotlib.pyplot import imshow</span><br><span class="line"></span><br><span class="line">import image_utils</span><br><span class="line">import model</span><br><span class="line">import ops</span><br><span class="line">import argparse</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num_styles = 32</span><br><span class="line">imgWidth = 512</span><br><span class="line">imgHeight = 512</span><br><span class="line">channel = 3</span><br><span class="line">checkpoint = &quot;/Users/Jiao/Desktop/TFProject/style-image/checkpoint/multistyle-pastiche-generator-varied.ckpt&quot;</span><br><span class="line"></span><br><span class="line">inputImage = tf.placeholder(tf.float32,shape=[None,imgWidth,imgHeight,channel],name=&quot;input&quot;)</span><br><span class="line">styles = tf.placeholder(tf.float32,shape=[num_styles],name=&quot;style&quot;)</span><br><span class="line"></span><br><span class="line">with tf.name_scope(&quot;&quot;):</span><br><span class="line">    transform = model.transform(inputImage,</span><br><span class="line">                            normalizer_fn=ops.weighted_instance_norm,</span><br><span class="line">                            normalizer_params=&#123;</span><br><span class="line">                                # &apos;weights&apos;: tf.constant(mixture),</span><br><span class="line">                                &apos;weights&apos; : styles,</span><br><span class="line">                                &apos;num_categories&apos;: num_styles,</span><br><span class="line">                                &apos;center&apos;: True,</span><br><span class="line">                                &apos;scale&apos;: True&#125;)</span><br><span class="line"></span><br><span class="line">model_saver = tf.train.Saver(tf.global_variables())</span><br><span class="line"></span><br><span class="line">with tf.Session() as sess:</span><br><span class="line">    tf.train.write_graph(sess.graph_def, &quot;/Users/Jiao/Desktop/TFProject/style-image/protobuf&quot;, &quot;input.pb&quot;)</span><br><span class="line">    #checkpoint = os.path.expanduser(checkpoint)</span><br><span class="line">    #if tf.gfile.IsDirectory(checkpoint):</span><br><span class="line">    #    checkpoint = tf.train.latest_checkpoint(checkpoint)</span><br><span class="line">    #    tf.logging.info(&apos;loading latest checkpoint file: &#123;&#125;&apos;.format(checkpoint))</span><br><span class="line">    #model_saver.restore(sess, checkpoint)</span><br><span class="line"></span><br><span class="line">    #newstyle = np.zeros([num_styles], dtype=np.float32)</span><br><span class="line">    #newstyle[18] = 0.5</span><br><span class="line">    #newstyle[17] = 0.5</span><br><span class="line">    #newImage = np.zeros((1,imgWidth,imgHeight,channel))</span><br><span class="line">    #style_image = transform.eval(feed_dict=&#123;inputImage:newImage,styles:newstyle&#125;)</span><br><span class="line">    #style_image = style_image[0]</span><br><span class="line">    #imshow(style_image)</span><br><span class="line">    #pyplot.show()</span><br></pre></td></tr></table></figure>
<p>这里输入节点是<code>input</code>和<code>style</code>，输出节点是 model 中的<code>transformer/expand/conv3/conv/Sigmoid</code>。</p>
<p>到此就将模型的计算图保存到了本地文件夹中。<br>接下来就是将图和 ckpt 中的参数合并，并且生成移动端的可以使用的 pb 文件，这一步可以参考我上一篇文章<a href="http://www.jianshu.com/p/f096fe2212ce" target="_blank" rel="noopener">《iOS+Tensorflow 实现图像识别》</a>，很容易就实现。</p>
<h2 id="iOS-工程"><a href="#iOS-工程" class="headerlink" title="iOS 工程"></a>iOS 工程</h2><hr>
<p>在上面准备工作中，如果你已经按步骤搭建好 iOS+TF 的工程，这里你只需要导入生成的最终 pb 文件就行了。工程结构如图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2641798-ca34abd1c875504c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="XCode工程"></p>
<p>然后在 iOS 使用 pb 文件，我这里直接导入了 Google 提供的<code>tensorflow_utils</code>，使用这个类里面的 LoadModel 方法可以很快的生成含有计算图的 session。</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    tensorflow::Status load_status;</span><br><span class="line">    load_status = LoadModel(@&quot;rounded_graph&quot;, @&quot;pb&quot;, &amp;tf_session);</span><br><span class="line">    if (!load_status.ok()) &#123;</span><br><span class="line">        LOG(FATAL) &lt;&lt; &quot;Couldn&apos;t load model: &quot; &lt;&lt; load_status;</span><br><span class="line">    &#125;</span><br><span class="line">    currentStyle = 0;</span><br><span class="line">    isDone = true;</span><br><span class="line">    _styleImageView.layer.borderColor = [UIColor grayColor].CGColor;</span><br><span class="line">    _styleImageView.layer.borderWidth = 0.5;</span><br><span class="line">    _ogImageView.layer.borderColor = [UIColor grayColor].CGColor;</span><br><span class="line">    _ogImageView.layer.borderWidth = 0.5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后就是获取图片，执行运算，生成艺术图片展示。这里图片需要转换成 bitmap 然后获取 data 值，展示图片也是相识的过程。具体代码如下：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">- (void)runCnn:(UIImage *)compressedImg</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char *pixels = [self getImagePixel:compressedImg];</span><br><span class="line">    int image_channels = 4;</span><br><span class="line">    tensorflow::Tensor image_tensor(</span><br><span class="line">                                    tensorflow::DT_FLOAT,</span><br><span class="line">                                    tensorflow::TensorShape(</span><br><span class="line">                                                            &#123;1, wanted_input_height, wanted_input_width, wanted_input_channels&#125;));</span><br><span class="line">    auto image_tensor_mapped = image_tensor.tensor&lt;float, 4&gt;();</span><br><span class="line">    tensorflow::uint8 *in = pixels;</span><br><span class="line">    float *out = image_tensor_mapped.data();</span><br><span class="line">    for (int y = 0; y &lt; wanted_input_height; ++y) &#123;</span><br><span class="line">        float *out_row = out + (y * wanted_input_width * wanted_input_channels);</span><br><span class="line">        for (int x = 0; x &lt; wanted_input_width; ++x) &#123;</span><br><span class="line">            tensorflow::uint8 *in_pixel =</span><br><span class="line">            in + (x * wanted_input_width * image_channels) + (y * image_channels);</span><br><span class="line">            float *out_pixel = out_row + (x * wanted_input_channels);</span><br><span class="line">            for (int c = 0; c &lt; wanted_input_channels; ++c) &#123;</span><br><span class="line">                out_pixel[c] = in_pixel[c];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    tensorflow::Tensor style(tensorflow::DT_FLOAT, tensorflow::TensorShape(&#123;32&#125;));</span><br><span class="line">    float *style_data = style.tensor&lt;float, 1&gt;().data();</span><br><span class="line">    memset(style_data, 0, sizeof(float) * 32);</span><br><span class="line">    style_data[currentStyle] = 1;</span><br><span class="line"></span><br><span class="line">    if (tf_session.get()) &#123;</span><br><span class="line">        std::vector&lt;tensorflow::Tensor&gt; outputs;</span><br><span class="line">        tensorflow::Status run_status = tf_session-&gt;Run(</span><br><span class="line">                                                        &#123;&#123;contentNode, image_tensor&#125;,</span><br><span class="line">                                                            &#123;styleNode, style&#125;&#125;,</span><br><span class="line">                                                        &#123;outputNode&#125;,</span><br><span class="line">                                                        &#123;&#125;,</span><br><span class="line">                                                        &amp;outputs);</span><br><span class="line">        if (!run_status.ok()) &#123;</span><br><span class="line">            LOG(ERROR) &lt;&lt; &quot;Running model failed:&quot; &lt;&lt; run_status;</span><br><span class="line">            isDone = true;</span><br><span class="line">            free(pixels);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            float *styledData = outputs[0].tensor&lt;float,4&gt;().data();</span><br><span class="line">            UIImage *styledImg = [self createImage:styledData];</span><br><span class="line">            dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                _styleImageView.image = styledImg;</span><br><span class="line">                dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(0.3 * NSEC_PER_SEC)), dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                    isDone = true;</span><br><span class="line">                    free(pixels);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (unsigned char *)getImagePixel:(UIImage *)image</span><br><span class="line">&#123;</span><br><span class="line">    int width = image.size.width;</span><br><span class="line">    int height = image.size.height;</span><br><span class="line">    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();</span><br><span class="line">    unsigned char *rawData = (unsigned char*) calloc(height * width * 4, sizeof(unsigned char));</span><br><span class="line">    NSUInteger bytesPerPixel = 4;</span><br><span class="line">    NSUInteger bytesPerRow = bytesPerPixel * width;</span><br><span class="line">    NSUInteger bitsPerComponent = 8;</span><br><span class="line">    CGContextRef context = CGBitmapContextCreate(rawData, width, height,</span><br><span class="line"></span><br><span class="line">                                                 bitsPerComponent, bytesPerRow, colorSpace,</span><br><span class="line"></span><br><span class="line">                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);</span><br><span class="line"></span><br><span class="line">    CGColorSpaceRelease(colorSpace);</span><br><span class="line">    CGContextDrawImage(context, CGRectMake(0, 0, width, height), image.CGImage);</span><br><span class="line">    UIImage *ogImg = [UIImage imageWithCGImage:CGBitmapContextCreateImage(context)];</span><br><span class="line">    dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">        _ogImageView.image = ogImg;</span><br><span class="line">    &#125;);</span><br><span class="line">    CGContextRelease(context);</span><br><span class="line">    return rawData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (UIImage *)createImage:(float *)pixels</span><br><span class="line">&#123;</span><br><span class="line">    unsigned char *rawData = (unsigned char*) calloc(wanted_input_height * wanted_input_width * 4, sizeof(unsigned char));</span><br><span class="line">    for (int y = 0; y &lt; wanted_input_height; ++y) &#123;</span><br><span class="line">        unsigned char *out_row = rawData + (y * wanted_input_width * 4);</span><br><span class="line">        for (int x = 0; x &lt; wanted_input_width; ++x) &#123;</span><br><span class="line">            float *in_pixel =</span><br><span class="line">            pixels + (x * wanted_input_width * 3) + (y * 3);</span><br><span class="line">            unsigned char *out_pixel = out_row + (x * 4);</span><br><span class="line">            for (int c = 0; c &lt; wanted_input_channels; ++c) &#123;</span><br><span class="line">                out_pixel[c] = in_pixel[c] * 255;</span><br><span class="line">            &#125;</span><br><span class="line">            out_pixel[3] = UINT8_MAX;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();</span><br><span class="line">    NSUInteger bytesPerPixel = 4;</span><br><span class="line">    NSUInteger bytesPerRow = bytesPerPixel * wanted_input_width;</span><br><span class="line">    NSUInteger bitsPerComponent = 8;</span><br><span class="line">    CGContextRef context = CGBitmapContextCreate(rawData, wanted_input_width, wanted_input_height,</span><br><span class="line"></span><br><span class="line">                                                 bitsPerComponent, bytesPerRow, colorSpace,</span><br><span class="line"></span><br><span class="line">                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);</span><br><span class="line"></span><br><span class="line">    CGColorSpaceRelease(colorSpace);</span><br><span class="line">    UIImage *retImg = [UIImage imageWithCGImage:CGBitmapContextCreateImage(context)];</span><br><span class="line">    CGContextRelease(context);</span><br><span class="line">    free(rawData);</span><br><span class="line">    return retImg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>这里说明一下，前面 python 工程已经定义了，我的输入和输出图片的大小是 512✕512。</em></p>
<h2 id="连接-iPhone，运行工程"><a href="#连接-iPhone，运行工程" class="headerlink" title="连接 iPhone，运行工程^_^"></a>连接 iPhone，运行工程^_^</h2><hr>
<p>最后连上手机运行，就可以自己创建自己的艺术类图片了。😊</p>
<p>放几张运行效果图：<br><img src="http://upload-images.jianshu.io/upload_images/2641798-d105c1089f62c634.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="截图1"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2641798-6b722e433ca66c5b.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="截图2"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/2641798-1b5acd6620b5b447.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="截图3"></p>

        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2016-08-02T02:49:54.000Z">2016-08-02</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/工作/">工作</a>&nbsp;/&nbsp;<a class="has-link-grey -link" href="/categories/工作/ACM/">ACM</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    14 分钟 读完 (大约 2050 个字)
                </span>
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2016/08/02/用DFS来排座位/">用DFS来排座位</a>
            
        </h1>
        <div class="content">
            <p>DFS（Depth-First-Search）深度优先算法，是搜索算法的一种。是一种在开发爬虫早期使用较多的方法。它的思想是从一个顶点 V0 开始，沿着一条路一直走到底，如果发现不能到达目标解，那就返回到上一个节点，然后从另一条路开始走到底，这种尽量往深处走的概念即是深度优先的概念。</p>
<p>深度优先搜索是图论中的经典算法，利用深度优先搜索算法可以产生目标图的相应拓扑排序表，利用拓扑排序表可以方便的解决很多相关的图论问题，如最大路径问题等等。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2641798-5ed96443e4c08337.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DFS"></p>
<p>下面以一个具体问题来看 DFS 的实现与实用。（问题来源[GCJ2016-1A]BFFs）</p>
<p><strong>Problem</strong><br>You are a teacher at the brand new Little Coders kindergarten. You have<strong>N</strong>kids in your class, and each one has a different student ID number from 1 through<strong>N</strong>. Every kid in your class has a single best friend forever (BFF), and you know who that BFF is for each kid. BFFs are not necessarily reciprocal – that is, B being A’s BFF does not imply that A is B’s BFF.<br>Your lesson plan for tomorrow includes an activity in which the participants must sit in a circle. You want to make the activity as successful as possible by building the largest possible circle of kids such that each kid in the circle is sitting directly next to their BFF, either to the left or to the right. Any kids not in the circle will watch the activity without participating.<br>What is the greatest number of kids that can be in the circle?<br><strong>Input</strong><br>The first line of the input gives the number of test cases,<strong>T</strong>.<strong>T</strong>test cases follow. Each test case consists of two lines. The first line of a test case contains a single integer<strong>N</strong>, the total number of kids in the class. The second line of a test case contains<strong>N</strong>integers<strong>F1</strong>,<strong>F2</strong>, …,<strong>FN</strong>, where<strong>Fi</strong>is the student ID number of the BFF of the kid with student ID i.<br><strong>Output</strong><br>For each test case, output one line containing “Case #x: y”, where x is the test case number (starting from 1) and y is the maximum number of kids in the group that can be arranged in a circle such that each kid in the circle is sitting next to his or her BFF.<br><strong>Limits</strong><br>1 ≤<strong>T</strong>≤ 100.<br>1 ≤<strong>Fi</strong>≤<strong>N</strong>, for all i.<br><strong>Fi</strong>≠ i, for all i. (No kid is their own BFF.)<br><strong>Small dataset</strong><br>3 ≤<strong>N</strong>≤ 10.<br><strong>Large dataset</strong><br>3 ≤<strong>N</strong>≤ 1000.<br><strong>Sample</strong></p>
<blockquote>
<p>Input<br>4<br>4<br>2 3 4 1<br>4<br>3 3 4 1<br>4<br>3 3 4 3<br>10<br>7 8 10 10 9 2 9 6 3 3<br>Output<br>Case #1: 4<br>Case #2: 3<br>Case #3: 3<br>Case #4: 6</p>
</blockquote>
<p>In sample case #4, the largest possible circle seats the following kids in the following order:7 9 3 10 4 1. (Any reflection or rotation of this circle would also work.) Note that the kid with student ID 1 is next to the kid with student ID 7, as required, because the list represents a circle.</p>
<p>解释：<br>一个幼儿园，有 N 个小朋友，编号从 1 到 N，每个孩子有一个永远最好的朋友。这个 BFF 不是相互的，A 是 B 的 BFF，不代表 B 也是 A 的的 BFF。接下来明天有节课需要小朋友坐成一个圈玩游戏，但是每个孩子都希望自己的左边或者右边坐的是自己的 BFF，没坐进去的小朋友就只能观看他们玩，那么这个圈最大能坐多少个小朋友？<br>输入第一个数 T 是测试数据的组数，然后每两行为一组，第一行一个数字是 N 小朋友的个数，第二行 N 个数字是编号 1 到 N 的孩子的最好朋友编号。<br>输出每行代表每组测试数据的最大圈坐小朋友数量。</p>
<p>分析：<br>第一步，我们需要找到每个孩子通过 BFF 这个关系单向能一共能链到多少孩子进来，这里就要用到 DFS 技术来实现。来看一下代码：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">void dfs(int *input, bool *flag ,int start, NSMutableArray *array)</span><br><span class="line">&#123;</span><br><span class="line">    if (flag[start - 1] == true) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        flag[start - 1] = true;</span><br><span class="line">        [array addObject:[NSNumber numberWithInt:start]];</span><br><span class="line">        start = input[start - 1];</span><br><span class="line">        dfs(input, flag, start, array);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里 input 是 BFF 关系数组，flag 是标志某一个小孩是否访问过的数组，start 代表从哪个小孩开始搜索，array 是最后我们要的链。从 start 传入的小孩编号开始搜索，将 start 自己写到 array 中并标记为已访问，然后 start 更新为自己的 BFF，迭代调用 dfs，直到走到标记为已访问节点停止搜索。然后将分别从 1 到 N 编号的小孩为起点的形成的最长链的都存储起来。这里我们存在 chainArray 里面，方便后面使用。</p>
<p>第二步，我们用刚才保存的链来拼接环，这里我们用一个数组来记录以每个孩子为起点的最大环长度 circle，同时用一个整数 maxNum 记录所有的环中最大值。然后我们开始遍历刚才记录在 chainArray 里面的链，计算他们能拼接最长环的大小。计算中分三种情况：<br>1、链的最后一位小朋友的最好朋友不是第一位与倒数第二位小孩。如：1-&gt;2-&gt;3-&gt;4，但是 4 的 BFF 是 2，那么这种链就是无效的，也不能够成环，长度就记为 0；<br>2、链的最后一位小朋友的最好朋友是第一位小孩。如：1-&gt;2-&gt;3-&gt;4，4 的 BFF 是 1，那么这种链就是自成环，长度记为链长度 4。<br>3、链的最后一位小朋友的最好朋友是倒数第二位小孩。如：1-&gt;2-&gt;3-&gt;4，4 的 BFF 是 3，这种链既自成环，又可以和其它以 3 结尾的链拼接成环，如 5-&gt;4-&gt;3，两个链拼接后就成了 1-&gt;2-&gt;3<->4&lt;-5。对于这种情况，我们就必须再次遍历所有链，找出和该链拼接后的最长链，记录为两链长度和减 2，并保存进 circle 中。<br>最后，每次更新过后环长度过后，需要更新 maxNum 的值。<br>实现代码如下：</-></p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    for (int j = 0; j &lt; N; j++) &#123;</span><br><span class="line">        NSArray *array = [chainArray objectAtIndex:j];</span><br><span class="line">        int length = (int)array.count;</span><br><span class="line">        int LastIndex = [[array lastObject] intValue];</span><br><span class="line">        int nextValue = input[LastIndex - 1];</span><br><span class="line">        if (nextValue != [[array firstObject] intValue] &amp;&amp; nextValue != [[array objectAtIndex:array.count - 2] intValue]) &#123;</span><br><span class="line">            length = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            if (nextValue == [[array objectAtIndex:array.count - 2] intValue]) &#123;</span><br><span class="line">                int MaxLength = 0;</span><br><span class="line">                for (NSArray *item in chainArray) &#123;</span><br><span class="line">                    int newLength = 0;</span><br><span class="line">                    if ([[item lastObject] intValue] == nextValue) &#123;</span><br><span class="line">                        newLength = length + (int)[item count] - 2;</span><br><span class="line">                    &#125;</span><br><span class="line">                    MaxLength = MAX(MaxLength, newLength);</span><br><span class="line">                &#125;</span><br><span class="line">                length = MaxLength;</span><br><span class="line">                if (circle[nextValue - 1] &lt; length) &#123;</span><br><span class="line">                    circle[nextValue - 1] = length;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        maxNum = MAX(maxNum, length);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>至此，我们基本找到了以所有孩子为起点能形成的单一环，但是并不是能形成的最大环。</p>
<p>第三步，找出最大的环大小，上面的 maxNum 已经记录了单环所能得到的最大值，但是对于如 1-&gt;2-&gt;3<->4<-5 这种回环，其实还是可以和其它回环进行拼接，如和="" 6-="">7<->8<-9 拼接，最后得到更大的环="" 1-="">2-&gt;3<->4&lt;-5\6-&gt;7<->8&lt;-9。所以我们需要把刚才 circle 中记录的回环长度都加起来除以 2，再来更新 maxNum 得到最终的结果，代码如下：</-></-></-9></-></-5></-></p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    int tot = 0;</span><br><span class="line">    for (int k = 0; k &lt; N; k ++) &#123;</span><br><span class="line">        tot += circle[k];</span><br><span class="line">    &#125;</span><br><span class="line">    maxNum = MAX(maxNum, tot / 2);</span><br><span class="line">    return maxNum;</span><br></pre></td></tr></table></figure>
<p>至此，我们就完美的利用 DFS 完成了对小朋友排座位的任务。<br>看一下输出判定结果：</p>
<blockquote>
<p>Small input<br>16 pointsSolve C-small<br>Judge’s response for last submission: Correct.<br>Large input<br>29 pointsSolve C-large<br>Judge’s response for last submission: Correct.</p>
</blockquote>
<p>完整代码：</p>
<figure class="highlight plain hljs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">//  main.m</span><br><span class="line">//  BFFs</span><br><span class="line">//</span><br><span class="line">//  Created by Jiao Liu on 4/16/16.</span><br><span class="line">//  Copyright © 2016 ChangHong. All rights reserved.</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">#import &lt;Foundation/Foundation.h&gt;</span><br><span class="line"></span><br><span class="line">void dfs(int *input, bool *flag ,int start, NSMutableArray *array)</span><br><span class="line">&#123;</span><br><span class="line">    if (flag[start - 1] == true) &#123;</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        flag[start - 1] = true;</span><br><span class="line">        [array addObject:[NSNumber numberWithInt:start]];</span><br><span class="line">        start = input[start - 1];</span><br><span class="line">        dfs(input, flag, start, array);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">long maxCircle(int *input, int N)</span><br><span class="line">&#123;</span><br><span class="line">    long maxNum = 0;</span><br><span class="line">    </span><br><span class="line">    NSMutableArray *chainArray = [NSMutableArray array];</span><br><span class="line">    int circle[N];</span><br><span class="line">    memset(circle, 0, sizeof(circle));</span><br><span class="line">    for (int i = 0; i &lt; N; i++) &#123;</span><br><span class="line">        bool flag[N];</span><br><span class="line">        memset(flag, false, sizeof(flag));</span><br><span class="line">        NSMutableArray *array = [NSMutableArray array];</span><br><span class="line">        dfs(input, flag, i + 1, array);</span><br><span class="line">        [chainArray addObject:array];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    for (int j = 0; j &lt; N; j++) &#123;</span><br><span class="line">        NSArray *array = [chainArray objectAtIndex:j];</span><br><span class="line">        int length = (int)array.count;</span><br><span class="line">        int LastIndex = [[array lastObject] intValue];</span><br><span class="line">        int nextValue = input[LastIndex - 1];</span><br><span class="line">        if (nextValue != [[array firstObject] intValue] &amp;&amp; nextValue != [[array objectAtIndex:array.count - 2] intValue]) &#123;</span><br><span class="line">            length = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">            if (nextValue == [[array objectAtIndex:array.count - 2] intValue]) &#123;</span><br><span class="line">                int MaxLength = 0;</span><br><span class="line">                for (NSArray *item in chainArray) &#123;</span><br><span class="line">                    int newLength = 0;</span><br><span class="line">                    if ([[item lastObject] intValue] == nextValue) &#123;</span><br><span class="line">                        newLength = length + (int)[item count] - 2;</span><br><span class="line">                    &#125;</span><br><span class="line">                    MaxLength = MAX(MaxLength, newLength);</span><br><span class="line">                &#125;</span><br><span class="line">                length = MaxLength;</span><br><span class="line">                if (circle[nextValue - 1] &lt; length) &#123;</span><br><span class="line">                    circle[nextValue - 1] = length;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        maxNum = MAX(maxNum, length);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    int tot = 0;</span><br><span class="line">    for (int k = 0; k &lt; N; k ++) &#123;</span><br><span class="line">        tot += circle[k];</span><br><span class="line">    &#125;</span><br><span class="line">    maxNum = MAX(maxNum, tot / 2);</span><br><span class="line">    return maxNum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, const char * argv[]) &#123;</span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line">        // insert code here...</span><br><span class="line">        freopen(&quot;/Users/Jiao/Desktop/CodeJam/BFFs/C-large-practice.in&quot;, &quot;r&quot;, stdin);</span><br><span class="line">//        freopen(&quot;/Users/Jiao/Desktop/CodeJam/BFFs/C-large-practice.out&quot;, &quot;w&quot;, stdout);</span><br><span class="line">        int T;</span><br><span class="line">        scanf(&quot;%d&quot;,&amp;T);</span><br><span class="line">        for (int i = 1; i&lt;=T; i++) &#123;</span><br><span class="line">            int N;</span><br><span class="line">            scanf(&quot;%d&quot;,&amp;N);</span><br><span class="line">            int Bffs[N];</span><br><span class="line">            for (int j = 0; j&lt;N; j++) &#123;</span><br><span class="line">                int bestFriend;</span><br><span class="line">                scanf(&quot;%d&quot;,&amp;bestFriend);</span><br><span class="line">                Bffs[j]=bestFriend;</span><br><span class="line">            &#125;</span><br><span class="line">            printf(&quot;Case #%d: %ld\n&quot;,i,maxCircle(Bffs,N));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        </div>
        
        
        
    </div>
</div>








</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered">
                <div>
                    <img class="image is-128x128 has-mb-6" src="/images/avatar.png" alt="Jiao Liu">
                    
                    <p class="is-size-4 is-block">
                        Jiao Liu
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Software Engineer
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>Chengdu,China</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        4
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        6
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        10
                    </p>
                </div>
            </div>
        </nav>
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/JiaoLiu">
                关注我</a>
        </div>
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank" title="Github" href="https://github.com/JiaoLiu">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank" title="简书" href="https://www.jianshu.com/u/39482dc75069">
                
                <i class="fa fa-book"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/GCJ/" style="font-size: 10px;">GCJ</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/tensorflow/" style="font-size: 10px;">tensorflow</a> <a href="/tags/前端/" style="font-size: 10px;">前端</a> <a href="/tags/小熊猫/" style="font-size: 10px;">小熊猫</a> <a href="/tags/小程序/" style="font-size: 10px;">小程序</a> <a href="/tags/新生/" style="font-size: 10px;">新生</a> <a href="/tags/机器学习/" style="font-size: 10px;">机器学习</a> <a href="/tags/移动端/" style="font-size: 10px;">移动端</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a>
    </div>
</div>

    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/chmini-app/CHCharts-wechat" target="_blank">
                    <span class="level-left">
                        <span class="level-item">CHCharts</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


        
            
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/工作/">
            <span class="level-start">
                <span class="level-item">工作</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/工作/ACM/">
            <span class="level-start">
                <span class="level-item">ACM</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/工作/iOS/">
            <span class="level-start">
                <span class="level-item">iOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/工作/小程序/">
            <span class="level-start">
                <span class="level-item">小程序</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/生活/">
            <span class="level-start">
                <span class="level-item">生活</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/生活/小熊猫/">
            <span class="level-start">
                <span class="level-item">小熊猫</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
        
            
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2018/08/29/微信小程序中绘制雷达图/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="微信小程序中绘制雷达图">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-08-29T01:50:00.000Z">2018-08-29</time></div>
                    <a href="/2018/08/29/微信小程序中绘制雷达图/" class="has-link-black-ter is-size-6">微信小程序中绘制雷达图</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/工作/">工作</a> / <a class="has-link-grey -link" href="/categories/工作/小程序/">小程序</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/06/21/小熊猫来到世界/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="小熊猫来到世界">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-20T16:02:21.000Z">2018-06-21</time></div>
                    <a href="/2018/06/21/小熊猫来到世界/" class="has-link-black-ter is-size-6">小熊猫来到世界</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/生活/">生活</a> / <a class="has-link-grey -link" href="/categories/生活/小熊猫/">小熊猫</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2017/04/28/iOS实现类Prisma软件/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="iOS实现类Prisma软件">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2017-04-28T02:42:21.000Z">2017-04-28</time></div>
                    <a href="/2017/04/28/iOS实现类Prisma软件/" class="has-link-black-ter is-size-6">iOS实现类Prisma软件</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/工作/">工作</a> / <a class="has-link-grey -link" href="/categories/工作/iOS/">iOS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2016/08/02/用DFS来排座位/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="用DFS来排座位">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2016-08-02T02:49:54.000Z">2016-08-02</time></div>
                    <a href="/2016/08/02/用DFS来排座位/" class="has-link-black-ter is-size-6">用DFS来排座位</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/工作/">工作</a> / <a class="has-link-grey -link" href="/categories/工作/ACM/">ACM</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">四月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">八月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <ul class="menu-list">
                
                <li>
                    <a class="level is-marginless" href="/tags/GCJ/">
                        <span class="level-start">
                            <span class="level-item">GCJ</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/html/">
                        <span class="level-start">
                            <span class="level-item">html</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/tensorflow/">
                        <span class="level-start">
                            <span class="level-item">tensorflow</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/前端/">
                        <span class="level-start">
                            <span class="level-item">前端</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/小熊猫/">
                        <span class="level-start">
                            <span class="level-item">小熊猫</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/小程序/">
                        <span class="level-start">
                            <span class="level-item">小程序</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/新生/">
                        <span class="level-start">
                            <span class="level-item">新生</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/机器学习/">
                        <span class="level-start">
                            <span class="level-item">机器学习</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/移动端/">
                        <span class="level-start">
                            <span class="level-item">移动端</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/算法/">
                        <span class="level-start">
                            <span class="level-item">算法</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        

<div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            链接
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://github.com/chmini-app/CHCharts-wechat" target="_blank">
                    <span class="level-left">
                        <span class="level-item">CHCharts</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">github.com</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>


    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/工作/">
            <span class="level-start">
                <span class="level-item">工作</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/工作/ACM/">
            <span class="level-start">
                <span class="level-item">ACM</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/工作/iOS/">
            <span class="level-start">
                <span class="level-item">iOS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/工作/小程序/">
            <span class="level-start">
                <span class="level-item">小程序</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li><li>
        <a class="level is-marginless" href="/categories/生活/">
            <span class="level-start">
                <span class="level-item">生活</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a><ul><li>
        <a class="level is-marginless" href="/categories/生活/小熊猫/">
            <span class="level-start">
                <span class="level-item">小熊猫</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li></ul></li>
            </ul>
        </div>
    </div>
</div>
    
        
<div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2018/08/29/微信小程序中绘制雷达图/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="微信小程序中绘制雷达图">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-08-29T01:50:00.000Z">2018-08-29</time></div>
                    <a href="/2018/08/29/微信小程序中绘制雷达图/" class="has-link-black-ter is-size-6">微信小程序中绘制雷达图</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/工作/">工作</a> / <a class="has-link-grey -link" href="/categories/工作/小程序/">小程序</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2018/06/21/小熊猫来到世界/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="小熊猫来到世界">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2018-06-20T16:02:21.000Z">2018-06-21</time></div>
                    <a href="/2018/06/21/小熊猫来到世界/" class="has-link-black-ter is-size-6">小熊猫来到世界</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/生活/">生活</a> / <a class="has-link-grey -link" href="/categories/生活/小熊猫/">小熊猫</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2017/04/28/iOS实现类Prisma软件/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="iOS实现类Prisma软件">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2017-04-28T02:42:21.000Z">2017-04-28</time></div>
                    <a href="/2017/04/28/iOS实现类Prisma软件/" class="has-link-black-ter is-size-6">iOS实现类Prisma软件</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/工作/">工作</a> / <a class="has-link-grey -link" href="/categories/工作/iOS/">iOS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2016/08/02/用DFS来排座位/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="用DFS来排座位">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2016-08-02T02:49:54.000Z">2016-08-02</time></div>
                    <a href="/2016/08/02/用DFS来排座位/" class="has-link-black-ter is-size-6">用DFS来排座位</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/工作/">工作</a> / <a class="has-link-grey -link" href="/categories/工作/ACM/">ACM</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>

    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/06/">
                <span class="level-start">
                    <span class="level-item">六月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/04/">
                <span class="level-start">
                    <span class="level-item">四月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2016/08/">
                <span class="level-start">
                    <span class="level-item">八月 2016</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <ul class="menu-list">
                
                <li>
                    <a class="level is-marginless" href="/tags/GCJ/">
                        <span class="level-start">
                            <span class="level-item">GCJ</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/html/">
                        <span class="level-start">
                            <span class="level-item">html</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/tensorflow/">
                        <span class="level-start">
                            <span class="level-item">tensorflow</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/前端/">
                        <span class="level-start">
                            <span class="level-item">前端</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/小熊猫/">
                        <span class="level-start">
                            <span class="level-item">小熊猫</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/小程序/">
                        <span class="level-start">
                            <span class="level-item">小程序</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/新生/">
                        <span class="level-start">
                            <span class="level-item">新生</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/机器学习/">
                        <span class="level-start">
                            <span class="level-item">机器学习</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/移动端/">
                        <span class="level-start">
                            <span class="level-item">移动端</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
                <li>
                    <a class="level is-marginless" href="/tags/算法/">
                        <span class="level-start">
                            <span class="level-item">算法</span>
                        </span>
                        <span class="level-end">
                            <span class="level-item tag">1</span>
                        </span>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
  <div class="container">
    <div class="level">
      <div class="level-start has-text-centered-mobile">
        <a class="footer-logo is-block has-mb-6" href="/">
          
          <img src="/images/logo.png" alt="小熊猫的花园" height="28">
          
        </a>
        <p class="is-size-7">
          &copy; 2019 Jiao Liu&nbsp; at Chengdu,China
        </p>
      </div>
      <div class="level-end">
        
        <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
           
          <p class="control">
            <a class="button is-white is-large" target="_parent" title="Contact via E-mail" href="mailto:694121590@qq.com">
              
              <i class="fa fa-envelope"></i> 
            </a>
          </p>
          
          <p class="control">
            <a class="button is-white is-large" target="_parent" title="Contact via QQ" href="http://wpa.qq.com/msgrd?v=3&amp;uin=694121590&amp;site=jane66.com&amp;menu=yes">
              
              <i class="fab fa-qq"></i> 
            </a>
          </p>
          
        </div>
        
      </div>
    </div>
  </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>


    
    
    
    <script src="/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    <script src="/js/gallery.js" defer></script>
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {matchFontHeight: false},
        SVG: {matchFontHeight: false},
        CommonHTML: {matchFontHeight: false}
    });
});
</script>

    
    

<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>


    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    <script src="/js/clipboard.js" defer></script>
    

    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>